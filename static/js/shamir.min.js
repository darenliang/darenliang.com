(()=>{functionPlot({target:"#plot1",width:400,height:400,yAxis:{domain:[-2,6]},xAxis:{domain:[-2,6]},grid:!1,data:[{fn:"-x+4"},{points:[[0,4]],fnType:"points",graphType:"scatter"}],annotations:[{x:0,text:"x = 0"}]});functionPlot({target:"#plot2",width:400,height:400,yAxis:{domain:[-1,7]},xAxis:{domain:[-2,6]},grid:!1,data:[{fn:"x^2-4x+4"},{points:[[0,4]],fnType:"points",graphType:"scatter"}],annotations:[{x:0,text:"x = 0"}]});const n={target:"#plot3",width:400,height:400,yAxis:{domain:[-1,7]},xAxis:{domain:[-2,
6]},grid:!1,data:[{fn:"x^2-4x+4"},{points:[[2,0],[4,4]],fnType:"points",graphType:"scatter"}],annotations:[{x:0,text:"x = 0"}]},t=document.getElementById("sliderLabel");functionPlot(n);document.getElementById("slider").oninput=b=>{b=b.target.value;const a=-6*b+2,d=8*b-4;t.innerHTML=`${0>b?"- "+-(Math.round(100*b)/100):Math.round(100*b)/100} x^2 ${0>a?"- "+-(Math.round(100*a)/100):"+ "+Math.round(100*a)/100} x ${0>d?"- "+-(Math.round(100*d)/100):"+ "+Math.round(100*d)/100}`;n.data[0].fn=`(${b})x^2+(${a})x+(${d})`;
functionPlot(n)};const u=(b,a,d,c=170141183460469231731687303715884105727n)=>{if(a>d)throw"Pool secret would be irrecoverable.";const f=[BigInt(b)].concat([...Array(a-1).keys()].map(e=>{var g=170141183460469231731687303715884105726n.toString().length;for(e="";e.length<g;)e+=Math.random().toString().split(".")[1];e=e.slice(0,g);g="1"+"0".repeat(g);return 170141183460469231731687303715884105726n*BigInt(e)/BigInt(g)}));return[...Array(d).keys()].map(e=>{var g=BigInt(e+1);let h=0n;for(let l=f.length-
1;0<=l;l--)h*=BigInt(e+1),h+=f[l],h%=c;return[g,h]})},r=(b,a,d)=>{let c=0n,f=1n,e=1n,g=0n;for(;0n!==d;){if(0n===d)throw"Divide by zero.";var h=0n===a?0n:0n<a&&0n<d||0n>a&&0n>d?a/d:a/d-1n;[a,d]=[d,(a+d)%d];[c,f]=[f-h*c,c];[e,g]=[g-h*e,e]}return b*f},v=(b,a,d,c)=>{const f=a.length,e=k=>{let m=1n;for(const p of k)m*=p;return m},g=[],h=[];for(let k=0;k<f;k++){const m=a.slice(),p=BigInt(m.splice(k,1));g.push(e(m.map(q=>b-q)));h.push(e(m.map(q=>p-q)))}const l=e(h);a=[...Array(f).keys()].map(k=>r(g[k]*l*
d[k]%c,h[k],c)).reduce((k,m)=>k+m,0n);a=r(a,l,c);return 0n<a?a%c:(a+(-1n*a/c+1n)*c)%c},w=(b,a=170141183460469231731687303715884105727n)=>{if(2>b.length)throw"Need at least 2 shares";const d=[],c=[];for(const f of b)d.push(f[0]),c.push(f[1]);return v(0n,d,c,a)};window.onlyDigits=b=>/^\d+$/.test(b);window.generateShares1=b=>{b=document.getElementById("input1");if(/^\d+$/.test(b.value)){var a=document.getElementById("output1");a.value="";var d=1;for(const c of b.value)a.value+=`${c}${d}\n`,d++}else alert("Secret should only include digits.")};
window.recoverSecret1=b=>{b=document.getElementById("input1");var a=document.getElementById("output1");b.value="";const d=a.value.split("\n");a=new Map;for(var c of d)if(c=c.trim(),""!==c){if(!/^\d+$/.test(c)){alert("Shares should only include digits.");return}try{const f=Number.parseInt(c.substring(1));a.set(f,c.charAt(0))}catch{alert("Invalid share.");return}}for(c=1;c<a.size+1;c++)if(a.has(c))b.value+=a.get(c);else{alert("Invalid share.");break}};window.generateShares2=b=>{b=document.getElementById("input2");
if(/^\d+$/.test(b.value)){var a=b.value.length,d=b.value;b=document.getElementById("num2");if(/^\d+$/.test(b.value)){var c=parseInt(b.value);if(2>c)alert("Number of shares must be at least 2.");else{b=document.getElementById("output2");b.value="";var f=[];for(var e=0;e<c-1;e++)f.push(`${Math.floor(Math.random()*10**a)}`.padStart(a,"0"));a=d;for(const g of f){d=g;c="";for(e=1;e<=a.length;){const h=parseInt(a.charAt(a.length-e)),l=parseInt(d.charAt(d.length-e));c=`${(h+l)%10}`+c;e++}a=c}b.value+=`${a}\n`;
for(const g of f)b.value+=`${g}\n`}}else alert("Number of shares must be a whole number.")}else alert("Secret should only include digits.")};window.recoverSecret2=b=>{b=document.getElementById("input2");var a=document.getElementById("output2");b.value="";a=a.value.split("\n");var d=a.shift();for(let c of a){c=c.trim();if(""===c)continue;if(!/^\d+$/.test(c)){alert("Shares should only include digits.");return}a=d;d=c;let f="",e=1;for(;e<=a.length;){const g=parseInt(a.charAt(a.length-e)),h=parseInt(d.charAt(d.length-
e));f=`${(g-h+10)%10}`+f;e++}d=f}b.value=d};window.generateShares3=b=>{b=document.getElementById("input3");if(/^\d+$/.test(b.value)){b=parseInt(b.value);var a=document.getElementById("num3");if(/^\d+$/.test(a.value))if(a=parseInt(a.value),2>a)alert("Number of shares must be at least 2.");else{var d=document.getElementById("min3");if(/^\d+$/.test(d.value)){var c=parseInt(d.value);if(2>c)alert("Minimum number of shares must be at least 2.");else if(c>a)alert("Minimum number of shares cannot be bigger than the number of shares.");
else{d=document.getElementById("output3");d.value="";b=u(b,c,a);for(const f of b)d.value+=`${f[0]} ${f[1]}\n`}}else alert("Minimum number of shares must be a whole number.")}else alert("Number of shares must be a whole number.")}else alert("Secret should only include digits.")};window.recoverSecret3=b=>{b=document.getElementById("input3");var a=document.getElementById("output3");b.value="";const d=[];a=a.value.split("\n");for(var c of a){c=c.trim();if(""===c)continue;const [f,e]=c.split(" ");if(!/^\d+$/.test(f)||
!/^\d+$/.test(e)){alert("Shares should only have digit points.");return}d.push([BigInt(f),BigInt(e)])}c=w(d);b.value=`${c}`}})();
